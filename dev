#!/usr/bin/env bash

set -ae

iterate () {
  find ./src \( -iname "*" ! -iname ".*" \) | entr -c cargo test -- --nocapture
}

build () {
 cargo build
}

tests () {
 ./target/debug/sequence_rs ./examples/04_just_sound.seq > /tmp/test-result
}

build-nix () {
 time nix-build -E 'with import <nixpkgs> {}; callPackage ./default.nix {}' $@
}

test-nix () {
 ./result/bin/jam-seqs ./examples/03_minimal.seq
}

pushd $(dirname $(realpath $0)) > /dev/null
$@
popd > /dev/null
